import { expect, describe, it, beforeEach } from 'vitest'
import { extendExpect } from '@bearmint/bep-005'
extendExpect(expect)

import { base64ToBytes, base64ToHex, base64ToJson } from '../../source/base64.js'
import { bytesToHex } from '../../source/bytes.js'

describe('Bas64', () => {
	it('should convert tendermint base64 strings to JSON', () => {
		expect(
			base64ToJson(
				'eyJhZGRyZXNzIjoiYmVhcjFrcmFtMHlzc2d2N3EyNXU5czBsMnltcGhzOHJjcWw2MjA4bGt0MDhleXB5eGpjbmxwM3U5cHVocWEzbGw3djY5eTdmY3l5ZjRxZTc4Z3JrNGV2dyIsImF0dHJpYnV0ZXMiOnt9LCJiYWxhbmNlcyI6eyJCRUFSIjoiMTAwMDAwMDAwMDAwMDAwMDAwIiwiRklSRSI6IjEwMDAwMDAwMDAwMDAwMDAwMCIsIlNFRUQiOiIxMDAwMDAwMDAwMDAwMDAwMDAiLCJHT0xEIjoiMTIwMDAwMDAwMCJ9LCJsb2NrZWRCYWxhbmNlcyI6e30sIm5vbmNlIjoiMCIsInN0YWtlcyI6e30sInB1YmxpY0tleSI6ImIwZmJiNzkyMTA0MzNjMDU1Mzg1ODNmZWEyNmMzNzgxYzc4MDdmNGE3OWZmNjViY2Y5MjA0ODY5NjI3ZjBjNzg1MGYyZTBlYzdmZmYzMzQ1Mjc5MzgyMTEzNTA2N2M3NCIsIm5hbWUiOiJnZW5lc2lzXzEiLCJ2YWxpZGF0b3IiOnsiYWRkcmVzcyI6Ijc2NjdlMDJmYTljZDFlZjFkODgzZTVlNjQ4MjFiMTlkZDFhZjllOGMiLCJkaXN0cmlidXRpb24iOnsicGVyY2VudGFnZSI6MCwic3RyYXRlZ3kiOiJAYmVhcm1pbnQvYmVwODQifSwicHVibGljS2V5IjoiYTM0MDAxMDUyNDI1ZmFhMjY4ZjNhZTRkZjljODJjMTEyYzNmNDkyYTUxYmZmMjUxMTIwZDBkZWRmZWQ3MzM1YyIsInBvd2VyIjoiMSJ9fQ=="',
			),
		).toStrictEqual({
			address:
				'bear1kram0yssgv7q25u9s0l2ymphs8rcql6208lkt08eypyxjcnlp3u9puhqa3ll7v69y7fcyyf4qe78grk4evw',
			attributes: {},
			balances: {
				BEAR: '100000000000000000',
				FIRE: '100000000000000000',
				GOLD: '1200000000',
				SEED: '100000000000000000',
			},
			lockedBalances: {},
			name: 'genesis_1',
			nonce: '0',
			publicKey:
				'b0fbb79210433c05538583fea26c3781c7807f4a79ff65bcf9204869627f0c7850f2e0ec7fff33452793821135067c74',
			stakes: {},
			validator: {
				address: '7667e02fa9cd1ef1d883e5e64821b19dd1af9e8c',
				distribution: { percentage: 0, strategy: '@bearmint/bep84' },
				power: '1',
				publicKey: 'a34001052425faa268f3ae4df9c82c112c3f492a51bff251120d0dedfed7335c',
			},
		})
	})

	it('should convert tendermint base64 strings to JSON', () => {
		expect(
			bytesToHex(
				base64ToBytes(
					'eyJhZGRyZXNzIjoiYmVhcjFrcmFtMHlzc2d2N3EyNXU5czBsMnltcGhzOHJjcWw2MjA4bGt0MDhleXB5eGpjbmxwM3U5cHVocWEzbGw3djY5eTdmY3l5ZjRxZTc4Z3JrNGV2dyIsImF0dHJpYnV0ZXMiOnt9LCJiYWxhbmNlcyI6eyJCRUFSIjoiMTAwMDAwMDAwMDAwMDAwMDAwIiwiRklSRSI6IjEwMDAwMDAwMDAwMDAwMDAwMCIsIlNFRUQiOiIxMDAwMDAwMDAwMDAwMDAwMDAiLCJHT0xEIjoiMTIwMDAwMDAwMCJ9LCJsb2NrZWRCYWxhbmNlcyI6e30sIm5vbmNlIjoiMCIsInN0YWtlcyI6e30sInB1YmxpY0tleSI6ImIwZmJiNzkyMTA0MzNjMDU1Mzg1ODNmZWEyNmMzNzgxYzc4MDdmNGE3OWZmNjViY2Y5MjA0ODY5NjI3ZjBjNzg1MGYyZTBlYzdmZmYzMzQ1Mjc5MzgyMTEzNTA2N2M3NCIsIm5hbWUiOiJnZW5lc2lzXzEiLCJ2YWxpZGF0b3IiOnsiYWRkcmVzcyI6Ijc2NjdlMDJmYTljZDFlZjFkODgzZTVlNjQ4MjFiMTlkZDFhZjllOGMiLCJkaXN0cmlidXRpb24iOnsicGVyY2VudGFnZSI6MCwic3RyYXRlZ3kiOiJAYmVhcm1pbnQvYmVwODQifSwicHVibGljS2V5IjoiYTM0MDAxMDUyNDI1ZmFhMjY4ZjNhZTRkZjljODJjMTEyYzNmNDkyYTUxYmZmMjUxMTIwZDBkZWRmZWQ3MzM1YyIsInBvd2VyIjoiMSJ9fQ=="',
				),
			),
		).toBe(
			'7b2261646472657373223a2262656172316b72616d30797373677637713235753973306c32796d706873387263716c363230386c6b74303865797079786a636e6c703375397075687161336c6c3776363979376663797966347165373867726b34657677222c2261747472696275746573223a7b7d2c2262616c616e636573223a7b2242454152223a22313030303030303030303030303030303030222c2246495245223a22313030303030303030303030303030303030222c2253454544223a22313030303030303030303030303030303030222c22474f4c44223a2231323030303030303030227d2c226c6f636b656442616c616e636573223a7b7d2c226e6f6e6365223a2230222c227374616b6573223a7b7d2c227075626c69634b6579223a22623066626237393231303433336330353533383538336665613236633337383163373830376634613739666636356263663932303438363936323766306337383530663265306563376666663333343532373933383231313335303637633734222c226e616d65223a2267656e657369735f31222c2276616c696461746f72223a7b2261646472657373223a2237363637653032666139636431656631643838336535653634383231623139646431616639653863222c22646973747269627574696f6e223a7b2270657263656e74616765223a302c227374726174656779223a2240626561726d696e742f6265703834227d2c227075626c69634b6579223a2261333430303130353234323566616132363866336165346466396338326331313263336634393261353162666632353131323064306465646665643733333563222c22706f776572223a2231227d7d',
		)
	})

	it('should convert tendermint base64 strings to JSON', () => {
		expect(
			base64ToHex(
				'eyJhZGRyZXNzIjoiYmVhcjFrcmFtMHlzc2d2N3EyNXU5czBsMnltcGhzOHJjcWw2MjA4bGt0MDhleXB5eGpjbmxwM3U5cHVocWEzbGw3djY5eTdmY3l5ZjRxZTc4Z3JrNGV2dyIsImF0dHJpYnV0ZXMiOnt9LCJiYWxhbmNlcyI6eyJCRUFSIjoiMTAwMDAwMDAwMDAwMDAwMDAwIiwiRklSRSI6IjEwMDAwMDAwMDAwMDAwMDAwMCIsIlNFRUQiOiIxMDAwMDAwMDAwMDAwMDAwMDAiLCJHT0xEIjoiMTIwMDAwMDAwMCJ9LCJsb2NrZWRCYWxhbmNlcyI6e30sIm5vbmNlIjoiMCIsInN0YWtlcyI6e30sInB1YmxpY0tleSI6ImIwZmJiNzkyMTA0MzNjMDU1Mzg1ODNmZWEyNmMzNzgxYzc4MDdmNGE3OWZmNjViY2Y5MjA0ODY5NjI3ZjBjNzg1MGYyZTBlYzdmZmYzMzQ1Mjc5MzgyMTEzNTA2N2M3NCIsIm5hbWUiOiJnZW5lc2lzXzEiLCJ2YWxpZGF0b3IiOnsiYWRkcmVzcyI6Ijc2NjdlMDJmYTljZDFlZjFkODgzZTVlNjQ4MjFiMTlkZDFhZjllOGMiLCJkaXN0cmlidXRpb24iOnsicGVyY2VudGFnZSI6MCwic3RyYXRlZ3kiOiJAYmVhcm1pbnQvYmVwODQifSwicHVibGljS2V5IjoiYTM0MDAxMDUyNDI1ZmFhMjY4ZjNhZTRkZjljODJjMTEyYzNmNDkyYTUxYmZmMjUxMTIwZDBkZWRmZWQ3MzM1YyIsInBvd2VyIjoiMSJ9fQ=="',
			),
		).toBe(
			'7b2261646472657373223a2262656172316b72616d30797373677637713235753973306c32796d706873387263716c363230386c6b74303865797079786a636e6c703375397075687161336c6c3776363979376663797966347165373867726b34657677222c2261747472696275746573223a7b7d2c2262616c616e636573223a7b2242454152223a22313030303030303030303030303030303030222c2246495245223a22313030303030303030303030303030303030222c2253454544223a22313030303030303030303030303030303030222c22474f4c44223a2231323030303030303030227d2c226c6f636b656442616c616e636573223a7b7d2c226e6f6e6365223a2230222c227374616b6573223a7b7d2c227075626c69634b6579223a22623066626237393231303433336330353533383538336665613236633337383163373830376634613739666636356263663932303438363936323766306337383530663265306563376666663333343532373933383231313335303637633734222c226e616d65223a2267656e657369735f31222c2276616c696461746f72223a7b2261646472657373223a2237363637653032666139636431656631643838336535653634383231623139646431616639653863222c22646973747269627574696f6e223a7b2270657263656e74616765223a302c227374726174656779223a2240626561726d696e742f6265703834227d2c227075626c69634b6579223a2261333430303130353234323566616132363866336165346466396338326331313263336634393261353162666632353131323064306465646665643733333563222c22706f776572223a2231227d7d',
		)
	})
})
